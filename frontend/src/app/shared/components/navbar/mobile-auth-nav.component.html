<div class="mobile-nav-auth" [class.authenticated]="auth.isAuthenticated()">
  <ng-container *ngIf="!auth.isAuthenticated(); else authenticatedTemplate">
    <form [formGroup]="form" (ngSubmit)="submit()" class="auth-form" novalidate>
      <header class="form-header">
        <h3>Employee Login</h3>
        <p>Sign in with your work email to access the internal dashboard.</p>
      </header>

      <div
        class="form-field"
        [class.invalid]="form.controls.email.invalid && form.controls.email.touched"
      >
        <label for="auth-email">Email</label>
        <input
          id="auth-email"
          type="email"
          formControlName="email"
          autocomplete="email"
          placeholder="you@company.com"
          (keydown.enter)="submit()"
        />
        <div class="field-error" *ngIf="form.controls.email.errors && form.controls.email.touched">
          <span *ngIf="form.controls.email.errors['required']">Email is required.</span>
          <span *ngIf="form.controls.email.errors['email']">Enter a valid email address.</span>
        </div>
      </div>

      <div
        class="form-field password-field"
        [class.invalid]="form.controls.password.invalid && form.controls.password.touched"
      >
        <label for="auth-password">Password</label>
        <input
          id="auth-password"
          [type]="showPassword() ? 'text' : 'password'"
          formControlName="password"
          autocomplete="current-password"
          placeholder="••••••••"
          autocapitalize="off"
          autocorrect="off"
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePassword()"
          [attr.aria-pressed]="showPassword()"
          [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'"
        >
          <span class="toggle-label">
            {{ showPassword() ? 'Hide' : 'Show' }} password
          </span>
        </button>
        <div class="field-error" *ngIf="form.controls.password.errors && form.controls.password.touched">
          <span>Password is required.</span>
        </div>
      </div>

      <div class="form-error" *ngIf="errorMessage()">
        {{ errorMessage() }}
      </div>

      <button type="submit" class="login-button" [disabled]="loading()">
        <span *ngIf="!loading()">Login</span>
        <span *ngIf="loading()" class="loading-indicator">
          <span class="spinner"></span>
          Connecting…
        </span>
      </button>
    </form>
  </ng-container>

  <ng-template #authenticatedTemplate>
    <section class="auth-success">
      <div class="employee-header">
        <h3>{{ employeeName() }}</h3>
        <div class="connected-indicator">
          <span class="status-dot"></span>
          Connected
        </div>
      </div>

      <p class="employee-details">
        <span>{{ employeeRole() }}</span>
        <span class="separator">•</span>
        <span>{{ employeeDepartment() }}</span>
      </p>

      <button type="button" class="logout-button" (click)="logout()">
        Logout
      </button>
    </section>
  </ng-template>
</div>
