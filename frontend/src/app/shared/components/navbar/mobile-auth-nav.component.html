<div class="mobile-nav-auth" [class.authenticated]="auth.isAuthenticated()">
  @if (!auth.isAuthenticated()) {
    <form [formGroup]="form" (ngSubmit)="submit()" class="auth-form" novalidate>
      <header class="form-header">
        <h3>Employee Login</h3>
        <p>Sign in with your work email to access the internal dashboard.</p>
      </header>

      <div
        class="form-field"
        [class.invalid]="form.controls.email.invalid && form.controls.email.touched"
      >
        <label for="auth-email">Email</label>
        <input
          id="auth-email"
          type="email"
          formControlName="email"
          autocomplete="email"
          placeholder="you@company.com"
          (keydown.enter)="submit()"
        />
        @if (form.controls.email.errors && form.controls.email.touched) {
          <div class="field-error">
            @if (form.controls.email.errors['required']) {
              <span>Email is required.</span>
            }
            @if (form.controls.email.errors['email']) {
              <span>Enter a valid email address.</span>
            }
          </div>
        }
      </div>

      <div
        class="form-field password-field"
        [class.invalid]="form.controls.password.invalid && form.controls.password.touched"
      >
        <label for="auth-password">Password</label>
        <input
          id="auth-password"
          [type]="showPassword() ? 'text' : 'password'"
          formControlName="password"
          autocomplete="current-password"
          placeholder="********"
          autocapitalize="off"
          autocorrect="off"
        />
        <button
          type="button"
          class="toggle-password"
          (click)="togglePassword()"
          [attr.aria-pressed]="showPassword()"
          [attr.aria-label]="showPassword() ? 'Hide password' : 'Show password'"
        >
          <span class="toggle-label">
            {{ showPassword() ? 'Hide' : 'Show' }} password
          </span>
        </button>
        @if (form.controls.password.errors && form.controls.password.touched) {
          <div class="field-error">
            <span>Password is required.</span>
          </div>
        }
      </div>

      @if (errorMessage()) {
        <div class="form-error">
          {{ errorMessage() }}
        </div>
      }

      <button type="submit" class="login-button" [disabled]="loading()">
        @if (!loading()) {
          <span>Login</span>
        } @else {
          <span class="loading-indicator">
            <span class="spinner"></span>
            Connecting...
          </span>
        }
      </button>
    </form>

    <app-demo-login></app-demo-login>
  } @else {
    <section class="auth-success">
      <div class="employee-header">
        <h3>{{ employeeName() }}</h3>
        <div class="connected-indicator">
          <span class="status-dot"></span>
          Connected
        </div>
      </div>

      <p class="employee-details">
        <span>{{ employeeRole() }}</span>
        <span class="separator">&bull;</span>
        <span>{{ employeeDepartment() }}</span>
      </p>

      @if (isAdmin()) {
        <a routerLink="/admin" class="role-dashboard-button">
          Go to Admin Dashboard
        </a>
      }

      @if (isHr()) {
        <a routerLink="/hr" class="role-dashboard-button">
          Go to HR Dashboard
        </a>
      }

      <button type="button" class="logout-button" (click)="logout()">
        Logout
      </button>
    </section>
  }
</div>
